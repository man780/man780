# Архитектура DataMP

Добро пожаловать в документацию по архитектуре микросервисов для нашей системы автобиддера! В данной документации я предоставлю подробное описание структуры и функциональности различных микросервисов, составляющих нашу систему.

Наша система охватывает несколько ключевых микросервисов, каждый из которых выполняет свои специфические задачи, чтобы обеспечить надежную и эффективную работу системы. Ниже приведены основные, описанные в данной документации:
#### CORE:
  Микросервис представляет собой наиболее фундаментальный компонент системы. Внутри этого модуля находится логика, необходимая для управления балансами магазинов, финансовыми операциями (пополнениями и платежами) и "системными" операциями, предназначенными для помощи менеджерам в их операционных потребностях.

  В этот микросервис ни кто не может обращаться извне (для безопасности продукта). Так как вся бизнес логика процессов будет хранится именно тут. Кроме внутренних служб системы, микросервис также выступает в роли веб-API для магазинов нашей системы. Поэтому крайне важно поддерживать стабильность и обратную совместимость `API` при каждом новом выпуске.

#### ADMIN: 
  Микросервис представляет собой панель управления, служащую для администрирования нашей системы. Он обрабатывает логику, необходимую для удовлетворения всех операционных потребностей административного персонала и помогает поддерживать общее здоровье системы.

  Кроме того, "Административная панель" отвечает за работу с логами `ELK` из всех других приложений (включая само приложение `ADMIN`). Ее активно будут использовать сотрудники службы поддержки для мониторинга общего состояния системы и выявления потенциальных проблем с нашими приложениями.
  
#### COMMUNICATION
  Микросервис является бэкэндом для нашей системы и управляет логикой, необходимой для соединения различных клиентских приложений с ядром приложения. Эти этапы могут включать в себя регистрацию (подключение к платежной системе), верификацию электронной почты и/или номера телефона (подтверждение различных коммуникационных каналов) и верификацию личности пользователя.

#### GATE
  Микросервис является бэкэндом для системы и управляет логикой, необходимой для соединения различных клиентских приложений (для _веб-платформы_ и _мобильных приложений_) с ядром приложения (ядром `CORE` системы). Кроме того, `GATE` отвечает за управление общим рабочим процессом пользователей, включая различные этапы жизненного цикла пользователя. Эти этапы могут включать в себя регистрацию (подключение к системе), верификацию электронной почты и/или номера телефона (подтверждение различных коммуникационных каналов).

  Веб приложение и мобильное приложение использует процесс аутентификации через токены доступа, которые отправляются с каждым запросом для подтверждения аутентификации пользователя.

  Микросервис `GATE` играет важную роль в обеспечении связи между различными клиентскими приложениями и ядром системы, а также в управлении жизненным циклом `token`ов пользователей.

В этой архитектуре все микросервисы обшаются (передают данные) через `REST API`

**Обзор технологий.** Я выбрал `Django` в качестве нашего основного веб-фреймворка, используем `Django ORM` для взаимодействия с базой данных и `requests` для работы с `HTTP`. Модели `ORM` будут находятся в отдельном пакете `datamp-models` и они версионируются, чтобы избежать несоответствий в определениях моделей.

## Databases
#### PostgreSQL
Тут будут хранятся все таблицы и данные системы.
#### ClickHouse
Будет как резевной копией основной базы. Многи аналитические данные будут браться в том числе от сюда
#### MongoDB
Тут тоже можно органиовать некоторую логику хранение данных а так же тут можно хранить логи
#### Redis
В основном для кэширования данных

### Тут ссылка на архитектуру веб приложение
[MIRO](https://miro.com/welcomeonboard/OFRKQTdnS0JZTTJvSHQ3RUhpcTEycEdBMk94UVpIMGFEZE5PaHRVYUVwcjJsaWNMU2loYmNDOTFwM0hsQmpCVnwzMDc0NDU3MzU1MTA0NjA5MzI5fDI=?share_link_id=888767414667)

Дальше надо еше углублятся по каждому пункту и в отдельном файле описать дальнейшую бизнес логику по каждому микросервису, в особенности ядра `CORE`. Нарисовать `UML` схемы и описать все бизнес процессы.
Так же предпологается внедререние: 
- [gitlab.datamp.ru](https://gitlab.com) для хранение репозиториев каждого микросервиса как отдельного проекта и взаимодействие с CI/CD,
- [sentry.datamp.ru](https://sentry.io/) для отслеживание ошибок и управление ими. В удобном интерфейсе отображается все ошибки, так же отправляет ошибки через Telegram, на почту или другими каналами. Можно настроить уровни отпраляемых ошибок (`Critical`, `Error`, `Warning`, ...)
